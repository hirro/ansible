---

- name: Create required directories
  file: path=/opt/jhipster-registry/ state=directory

- name: Copy public key for GIT access
  copy: content=jim.pub dest=/opt/jhipster-registry/jim.pub mode="u+r"

- name: Start jhipster-registry
  docker_container:
    name: jhipster-registry
    image: jhipster/jhipster-registry
    restart_policy: unless-stopped    
    memory: 2G
    ports:
      - 8761:8761
    env:
      GIT_URI: https://github.com/hirro/wt-config
      GIT_SEARCH_PATHS: ""
      SPRING_PROFILES_ACTIVE: prod
    volumes:
      - /opt/jhipster-registry/jim.pub:/root/.ssh/id_rsa.pub
